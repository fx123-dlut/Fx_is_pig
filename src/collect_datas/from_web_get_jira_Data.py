# coding:utf-8
import requests
from lxml import html
from random import choice
import src.tools.write_to_xls as wtx
import configure as c


pro_name = c.pro_name
max = c.max_jira
base_url = c.base_url
res_name = c.pro_name+'_issue_info'
max_conn = 10
headers=[
"Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/80.0.3987.87 Safari/537.36 SE 2.X MetaSr 1.0",
"Mozilla/5.0 (Windows NT 6.3; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/91.0.4472.114 Safari/537.36]"
]
file_headers = ['title','type','status','priority','resolution','affect version','fix version']

project_init_data_path = c.res_path+'init_data/'

def get_info():
    res = []
    for i in range(0,max):
        this_url = base_url+str(i+1)
        header = {"User-Agent":choice(headers)}
        print(str(i)+"/"+str(max)+" "+this_url)
        req = requests.get(this_url,headers=header,timeout = 7)
        web = req.text
        etree = html.etree
        root = etree.HTML(web)
        req.close()
        this_res = []

        title1 = root.xpath('//title/text()')[-1].strip()
        if(title1[0:6]=='Log in'):
            continue
        type = root.xpath('//span[@id="type-val"]/text()')[-1].strip()
        status = root.xpath('//span[@id="status-val"]/span/text()')[-1].strip()
        priority = root.xpath('//span[@id="priority-val"]/text()')[-1].strip()
        resolution = root.xpath('//span[@id="resolution-val"]/text()')[-1].strip()
        affect_v = root.xpath('//span[@id="versions-val"]/text()')[-1].strip()
        fix_v = root.xpath('//span[@id="fixfor-val"]/text()')[-1].strip()
        if(affect_v == ''):
            affect_v = root.xpath('//span[@id="versions-val"]/span/span/text()')[-1].strip()
        if(fix_v == ''):
            fix_v = root.xpath('//span[@id="fixfor-val"]/span/a/text()')[-1].strip()
        this_res.append(title1)
        this_res.append(type)
        this_res.append(status)
        this_res.append(priority)
        this_res.append(resolution)
        this_res.append(affect_v)
        this_res.append(fix_v)

        res.append(this_res)
        print(len(res))
        print(this_res)
        print(res)
    return res

def get_only_bug_version(info):
    res = []
    for i in info:
        if i[1] == 'Bug' and (i[2] == 'Closed' or i[2] == 'Resolved'):
            res.append(i)
    wtx.save_to_init_xls(file_headers,res,'only_bug',res_name+'_only_bug_version')

def get_jira_info():
    res = get_info()
    # res = wtx.get_from_xls(project_init_data_path+res_name+'.xls')
    # res = [['[MRM-1] commons-lang 1.0-b1 not converted - ASF JIRA', 'Bug', 'Closed', 'Major', 'Fixed', 'None', '1.0-alpha-1'], ['[MRM-2] repository: transitive dependency report - ASF JIRA', 'New Feature', 'Closed', 'Major', 'Fixed', 'None', '1.0-alpha-1'], ['[MRM-3] NPE in repoclean - ASF JIRA', 'Bug', 'Closed', 'Major', 'Fixed', 'None', '1.0-alpha-1'], ['[MRM-4] repoclean overwrites valid poms with dummy poms when there was none in m1 repo - ASF JIRA', 'Bug', 'Closed', 'Major', 'Fixed', 'None', '1.0-alpha-1'], ["[MRM-5] repository tools don't convert RELEASE files - ASF JIRA", 'Bug', 'Closed', 'Major', 'Fixed', 'None', '1.0-alpha-1'], ['[MRM-6] validator: report if artifacts are out of place - ASF JIRA', 'New Feature', 'Closed', 'Trivial', 'Fixed', 'None', '1.0-alpha-1'], ['[MRM-7] postgresql-7.4.1-jdbc3.pom badly converted - ASF JIRA', 'Bug', 'Closed', 'Major', "Won't Fix", 'None', '1.0-alpha-1'], ['[MRM-8] Remove generated model source code from repoclean project, use model dependencies instead. - ASF JIRA', 'Improvement', 'Closed', 'Minor', 'Fixed', 'None', '1.0-alpha-1'], ['[MRM-9] migrate converter to repository manager - ASF JIRA', 'Task', 'Closed', 'Major', 'Fixed', 'None', '1.0-alpha-1'], ['[MRM-10] syncopate needs to validate the incoming directory layout - ASF JIRA', 'Improvement', 'Closed', 'Major', "Won't Fix", 'None', 'None'], ['[MRM-11] Security policy for uploads must be in place - ASF JIRA', 'Task', 'Closed', 'Major', 'Fixed', 'None', '1.0-alpha-1'], ['[MRM-12] POI directory structure incorrectly converted from m1 repo - ASF JIRA', 'Bug', 'Closed', 'Major', 'Fixed', 'None', '1.0-alpha-1'], ['[MRM-13] utilise repository relocation information during conversion of an artifact - ASF JIRA', 'New Feature', 'Closed', 'Major', 'Fixed', 'None', '1.0-alpha-1'], ['[MRM-14] utilise repository relocation information to update dependencies - ASF JIRA', 'New Feature', 'Closed', 'Major', "Won't Fix", 'None', 'Backlog'], ['[MRM-15] partial POM written even on exception - ASF JIRA', 'Bug', 'Closed', 'Major', 'Fixed', 'None', '1.0-alpha-1'], ['[MRM-16] reporting: report on bad metadata files - ASF JIRA', 'Task', 'Closed', 'Major', 'Fixed', 'None', '1.0-alpha-1'], ['[MRM-17] reporting: report on mismatched checksums - ASF JIRA', 'Task', 'Closed', 'Major', 'Fixed', 'None', '1.0-alpha-1'], ["[MRM-19] Make repoclean transform the m1 poms although jar files didn't change - ASF JIRA", 'Improvement', 'Closed', 'Minor', "Won't Fix", 'None', 'None'], ['[MRM-20] <type>test</type> should be converted to <type>jar</type> <scope>test</scope> - ASF JIRA', 'Improvement', 'Closed', 'Major', "Won't Fix", 'None', '1.0-alpha-1'], ['[MRM-21] <type>plugin</type> should be ignored - ASF JIRA', 'Improvement', 'Closed', 'Major', "Won't Fix", 'None', '1.0-alpha-1'], ["[MRM-22] if no directory in <resources>, assume '.' - ASF JIRA", 'Improvement', 'Closed', 'Major', 'Fixed', 'None', '1.0-alpha-1'], ["[MRM-23] Don't create empty m2 poms when there's no m1 pom - ASF JIRA", 'Improvement', 'Closed', 'Major', "Won't Fix", 'None', '1.0-alpha-1'], ['[MRM-25] Handle java sources in upload bundles - ASF JIRA', 'Improvement', 'Closed', 'Major', 'Fixed', '1.0', '1.0-alpha-1'], ['[MRM-26] Convert ${pom.currentVersion} to ${pom.version} - ASF JIRA', 'Bug', 'Closed', 'Major', 'Fixed', '1.0', '1.0-alpha-1'], ['[MRM-27] Handle optional property - ASF JIRA', 'Improvement', 'Closed', 'Major', 'Fixed', 'None', '1.0-alpha-1'], ["[MRM-28] sync shouldn't use file sizes as basis - updated checksums are not resynced - ASF JIRA", 'Bug', 'Closed', 'Major', "Won't Fix", 'None', 'None'], ['[MRM-29] Factorize pom conversion out of repoclean - ASF JIRA', 'Improvement', 'Closed', 'Major', 'Fixed', '1.0', '1.0-alpha-1'], ['[MRM-30] use post commit hook instead of svn update for poms - ASF JIRA', 'Bug', 'Closed', 'Critical', 'Fixed', 'None', '1.0-alpha-1'], ['[MRM-31] Create Reporting Standard APIs - ASF JIRA', 'Task', 'Closed', 'Major', 'Fixed', 'None', '1.0-alpha-1'], ['[MRM-32] Repository Indexing - ASF JIRA', 'New Feature', 'Closed', 'Major', 'Fixed', 'None', '1.0-alpha-1'], ['[MRM-33] add based on existing indexer for jar classes, packages and filenames - ASF JIRA', 'Sub-task', 'Closed', 'Major', 'Fixed', 'None', '1.0-alpha-1'], ['[MRM-34] add pom indexer - ASF JIRA', 'Sub-task', 'Closed', 'Major', 'Fixed', 'None', '1.0-alpha-1'], ['[MRM-35] add repository metadata indexer - ASF JIRA', 'Sub-task', 'Closed', 'Major', 'Fixed', 'None', '1.0-alpha-1'], ['[MRM-36] integration with discovery and scheduling - ASF JIRA', 'Sub-task', 'Closed', 'Major', 'Fixed', 'None', '1.0-alpha-1'], ['[MRM-37] discover the deletion of artifacts - ASF JIRA', 'Improvement', 'Closed', 'Major', 'Fixed', 'None', '1.0-beta-3'], ['[MRM-38] add a background task scheduler - ASF JIRA', 'New Feature', 'Closed', 'Major', 'Fixed', 'None', '1.0-alpha-1'], ['[MRM-39] caching repository query interface - ASF JIRA', 'New Feature', 'Closed', 'Major', 'Fixed', 'None', '1.0-alpha-1'], ['[MRM-40] associate artifacts with their pom and checksums - ASF JIRA', 'Task', 'Closed', 'Major', 'Fixed', 'None', '1.0-alpha-1'], ['[MRM-41] discover standalone POMs - ASF JIRA', 'Task', 'Closed', 'Major', 'Fixed', 'None', '1.0-alpha-1'], ['[MRM-42] discover repository metadata - ASF JIRA', 'Task', 'Closed', 'Major', 'Fixed', 'None', '1.0-alpha-1'], ['[MRM-43] integrate maven-proxy and/or proximity - ASF JIRA', 'Task', 'Closed', 'Major', 'Fixed', 'None', '1.0-alpha-1'], ['[MRM-44] search by group, artifact and version - ASF JIRA', 'Sub-task', 'Closed', 'Major', 'Fixed', 'None', '1.0-alpha-1'], ['[MRM-45] search by class or package name - ASF JIRA', 'Sub-task', 'Closed', 'Major', 'Fixed', 'None', '1.0-alpha-1'], ['[MRM-46] create application structure - ASF JIRA', 'Task', 'Closed', 'Major', 'Fixed', 'None', '1.0-alpha-1'], ['[MRM-47] add checksum indexer - ASF JIRA', 'Sub-task', 'Closed', 'Major', 'Fixed', 'None', '1.0-alpha-1'], ['[MRM-48] search by checksum - ASF JIRA', 'Sub-task', 'Closed', 'Major', 'Fixed', 'None', '1.0-alpha-1'], ['[MRM-49] Skeleton Unit tests for implementation of interfaces - ASF JIRA', 'Test', 'Closed', 'Major', 'Fixed', 'None', '1.0-alpha-1'], ['[MRM-50] Abstraction of Reporting test cases - ASF JIRA', 'Test', 'Closed', 'Major', 'Fixed', 'None', '1.0-alpha-1'], ['[MRM-51] Mock objects and additional classes - ASF JIRA', 'Test', 'Closed', 'Major', 'Fixed', 'None', '1.0-alpha-1'], ['[MRM-52] integrate with indexing - ASF JIRA', 'Sub-task', 'Closed', 'Major', 'Fixed', 'None', '1.0-alpha-1'], ['[MRM-53] repoort on invalid POMs - ASF JIRA', 'Task', 'Closed', 'Major', 'Fixed', 'None', '1.0-alpha-1'], ['[MRM-54] allow nested search parameters - ASF JIRA', 'Task', 'Closed', 'Major', 'Fixed', 'None', '1.0-alpha-1'], ["[MRM-55] don't add duplicates to the index - ASF JIRA", 'Bug', 'Closed', 'Major', 'Fixed', 'None', '1.0-alpha-1'], ['[MRM-56] ability to delete documents from the index - ASF JIRA', 'Bug', 'Closed', 'Major', 'Fixed', 'None', '1.0-alpha-1'], ['[MRM-57] ability to retrieve matched portion of classes, packages and files fields - ASF JIRA', 'Bug', 'Closed', 'Major', 'Fixed', 'None', '1.0-alpha-1'], ['[MRM-58] create a search result class for returning from search - ASF JIRA', 'Bug', 'Closed', 'Major', 'Fixed', 'None', '1.0-alpha-1'], ['[MRM-59] Proxy should work transparently with either maven 1.x or 2.x repositories. - ASF JIRA', 'New Feature', 'Closed', 'Major', 'Fixed', 'None', '1.0-alpha-1'], ['[MRM-60] Repository Manager should have a means to remove old snapshot builds - ASF JIRA', 'New Feature', 'Closed', 'Major', 'Fixed', 'None', '1.0-alpha-1'], ['[MRM-61] Searcher for metadata index - ASF JIRA', 'New Feature', 'Closed', 'Major', 'Fixed', 'None', '1.0-alpha-1'], ['[MRM-62] read maven-proxy configuration - ASF JIRA', 'Bug', 'Closed', 'Major', 'Fixed', 'None', '1.0-alpha-1'], ['[MRM-63] resolve permissions issues with checksum applet - ASF JIRA', 'Bug', 'Closed', 'Major', 'Fixed', 'None', '1.0-alpha-1'], ['[MRM-64] write page flows - ASF JIRA', 'Task', 'Closed', 'Major', 'Fixed', 'None', '1.0-alpha-1'], ['[MRM-65] deploy-bundle: license files is unused in upload bundle (should not be required) - ASF JIRA', 'Improvement', 'Closed', 'Minor', 'Fixed', 'None', '1.0-alpha-1'], ['[MRM-66] Repository configuration - ASF JIRA', 'Task', 'Closed', 'Major', 'Fixed', 'None', '1.0-alpha-1'], ['[MRM-67] Index maintenance - ASF JIRA', 'Task', 'Closed', 'Major', 'Fixed', 'None', '1.0-alpha-1'], ['[MRM-68] Accomodate "query everything" in the index - ASF JIRA', 'Task', 'Closed', 'Major', 'Fixed', 'None', '1.0-alpha-1'], ['[MRM-69] Simple "query everything" search - ASF JIRA', 'Task', 'Closed', 'Major', 'Fixed', 'None', '1.0-alpha-1'], ['[MRM-70] Browse by Group/Artifact/Version - ASF JIRA', 'Task', 'Closed', 'Major', 'Duplicate', '1.0', '1.0-alpha-1'], ['[MRM-72] Administration web user interface - ASF JIRA', 'Task', 'Closed', 'Major', 'Duplicate', '1.0', '1.0-alpha-1'], ['[MRM-73] Artifact Management web user interface - ASF JIRA', 'Task', 'Closed', 'Major', "Won't Fix", '1.0', '1.0-alpha-1'], ['[MRM-74] Browse web user interface - ASF JIRA', 'Task', 'Closed', 'Major', 'Fixed', '1.0', '1.0-alpha-1'], ['[MRM-75] Caching web user interface - ASF JIRA', 'Task', 'Closed', 'Major', "Won't Fix", '1.0', '1.0-alpha-1'], ['[MRM-76] Front End web user interface for configuring multiple repository proxy - ASF JIRA', 'Task', 'Closed', 'Major', 'Fixed', 'None', '1.0-alpha-1'], ['[MRM-77] Reporting web user interface - ASF JIRA', 'Task', 'Closed', 'Major', 'Fixed', 'None', '1.0-alpha-1'], ['[MRM-78] Repository Indexing web user interface - ASF JIRA', 'Task', 'Closed', 'Major', 'Duplicate', '1.0', '1.0-alpha-1'], ['[MRM-79] Repository Interface web user interface - ASF JIRA', 'Task', 'Closed', 'Major', 'Duplicate', '1.0', '1.0-alpha-1'], ['[MRM-80] Scheduling web user interface - ASF JIRA', 'Task', 'Closed', 'Major', 'Fixed', '1.0', '1.0-alpha-1'], ['[MRM-81] Search web user interface - ASF JIRA', 'Task', 'Closed', 'Major', 'Fixed', '1.0', '1.0-alpha-1'], ['[MRM-82] Reports should be components of their own so that new ones can be dropped in - ASF JIRA', 'Task', 'Closed', 'Major', 'Fixed', '1.0', '1.0-alpha-1'], ['[MRM-83] Reports should be passed a listener to be able to log their discoveries - ASF JIRA', 'Task', 'Closed', 'Major', "Won't Fix", '1.0', '1.0-alpha-1'], ['[MRM-84] Basic statistics - ASF JIRA', 'Task', 'Closed', 'Major', 'Fixed', '1.0', '1.2-M1'], ['[MRM-85] Repository access should be done through Wagon - ASF JIRA', 'Task', 'Closed', 'Major', 'Fixed', '1.0', '1.0-alpha-1'], ['[MRM-86] The operations on the repository must be transactional - ASF JIRA', 'Task', 'Closed', 'Major', 'Fixed', '1.0', '1.4-M1'], ['[MRM-87] Place a lockfile to prevent repository operations when there is a long ongoing process - ASF JIRA', 'Task', 'Closed', 'Major', "Won't Fix", '1.0', 'None'], ['[MRM-88] search by filename - ASF JIRA', 'Sub-task', 'Closed', 'Major', 'Fixed', 'None', '1.0-alpha-1'], ['[MRM-89] add sitemesh to webapp - ASF JIRA', 'Task', 'Closed', 'Major', 'Fixed', 'None', '1.0-alpha-1'], ['[MRM-90] add advanced search options - ASF JIRA', 'New Feature', 'Closed', 'Major', 'Fixed', 'None', '1.2-M1'], ['[MRM-91] create a second index with a subset of information, and have it compressed - ASF JIRA', 'New Feature', 'Closed', 'Major', 'Fixed', 'None', '1.0-alpha-1'], ['[MRM-92] some random ideas about the repository manager - ASF JIRA', 'New Feature', 'Closed', 'Major', 'Duplicate', 'None', '1.0-alpha-1'], ['[MRM-93] Use wagon for local cache operations - ASF JIRA', 'Task', 'Closed', 'Major', 'Duplicate', 'None', '1.0-alpha-1'], ['[MRM-94] report on duplicate jars in different parts of the repository - ASF JIRA', 'Improvement', 'Closed', 'Major', 'Fixed', 'None', '1.0-alpha-1'], ['[MRM-95] Allow cache timeout configurations for each proxied remote repository - ASF JIRA', 'Task', 'Closed', 'Major', 'Fixed', '1.0', '1.0-alpha-1'], ['[MRM-96] Enable the use of http proxies when mrm is restricted to browse directly over the net - ASF JIRA', 'Task', 'Closed', 'Major', 'Fixed', '1.0', '1.0-alpha-1'], ['[MRM-97] Allow hard-fail configuration for a remote repository - ASF JIRA', 'Task', 'Closed', 'Major', 'Fixed', '1.0', '1.0-alpha-1'], ['[MRM-98] Use the plexus configuration for index and repository path - ASF JIRA', 'Improvement', 'Closed', 'Major', 'Fixed', '1.0', '1.0-alpha-1'], ['[MRM-99] Use RepositoryIndexSearchLayer for searching in Packages - ASF JIRA', 'Bug', 'Closed', 'Major', 'Fixed', '1.0', '1.0-alpha-1'], ['[MRM-100] Make ProxyConfiguration into a plexus configuration object - ASF JIRA', 'Improvement', 'Closed', 'Major', "Won't Fix", 'None', '1.0-alpha-1'], ['[MRM-101] ProxyManagerFactory is not needed - ASF JIRA', 'Improvement', 'Closed', 'Major', 'Fixed', 'None', '1.0-alpha-1'], ['[MRM-102] ProxyManager enhancements - ASF JIRA', 'Improvement', 'Closed', 'Major', 'Fixed', 'None', '1.0-alpha-1'], ['[MRM-103] Make the artifact discoverers use the artifact utils - ASF JIRA', 'Improvement', 'Closed', 'Major', 'Fixed', 'None', '1.0-alpha-1'], ['[MRM-104] ProxyConfiguration enhancements - ASF JIRA', 'Improvement', 'Closed', 'Major', 'Fixed', 'None', '1.0-alpha-1'], ['[MRM-105] Use cacheFailure configuration in remote repositories - ASF JIRA', 'New Feature', 'Closed', 'Major', 'Fixed', 'None', '1.0-alpha-1'], ['[MRM-106] Keep only one http proxy configuration and have each repository whether to use it or not - ASF JIRA', 'Improvement', 'Closed', 'Major', 'Fixed', 'None', '1.0-alpha-1'], ['[MRM-107] Remove unnecessary maven-proxy classes from the remote-proxy - ASF JIRA', 'Improvement', 'Closed', 'Major', 'Fixed', 'None', '1.0-alpha-1'], ['[MRM-108] Add a MRM Goals WIki page - ASF JIRA', 'Wish', 'Closed', 'Major', 'Fixed', 'None', '1.0-alpha-1'], ['[MRM-109] Create a report on available plugins - ASF JIRA', 'New Feature', 'Open', 'Major', 'Unresolved', 'None', 'Backlog'], ['[MRM-110] Create a report on available Archetypes - ASF JIRA', 'New Feature', 'Open', 'Major', 'Unresolved', 'None', 'Backlog'], ['[MRM-111] Add support for serving JARDiff-ed Maven artifacts - ASF JIRA', 'Improvement', 'Closed', 'Major', "Won't Fix", 'None', 'Backlog'], ['[MRM-112] Creation of MetadataReposiotryIndex fails if provided index directory exists, but works if the directory does not exists - ASF JIRA', 'Bug', 'Closed', 'Major', 'Fixed', '1.0', '1.0-alpha-1'], ['[MRM-113] Create a group relocator tool - ASF JIRA', 'New Feature', 'Closed', 'Major', "Won't Fix", 'None', 'Backlog'], ['[MRM-114] NPE when the scheduler executes the discoverer job for indexing - ASF JIRA', 'Bug', 'Closed', 'Major', 'Fixed', 'None', '1.0-alpha-1'], ['[MRM-115] [ERROR] Nonexistent component: org.apache.maven.repository.discovery.ArtifactDiscovererdefault logged in webapp server when the repository webapp is accessed in browser - ASF JIRA', 'Bug', 'Closed', 'Major', 'Fixed', 'None', '1.0-alpha-1'], ['[MRM-116] Execute discoverer and indexing (if no index exists yet) when the repository webapp is accessed.  - ASF JIRA', 'Task', 'Closed', 'Major', 'Fixed', 'None', '1.0-alpha-1'], ['[MRM-117] support multiple repository proxy and artifact cache - ASF JIRA', 'New Feature', 'Closed', 'Major', 'Fixed', '1.0', '1.0-alpha-1'], ['[MRM-118] code review and clean up - ASF JIRA', 'Bug', 'Closed', 'Major', 'Fixed', '1.0', '1.0-alpha-1'], ['[MRM-119] Downloadable incremental repository indexes and common embedder API - ASF JIRA', 'New Feature', 'Closed', 'Critical', 'Incomplete', 'None', 'None'], ['[MRM-120] change default skin to match Continuum - ASF JIRA', 'Task', 'Closed', 'Major', 'Fixed', 'None', '1.0-alpha-1'], ['[MRM-121] wrong (incomplete) models returned from search - ASF JIRA', 'Bug', 'Closed', 'Critical', 'Duplicate', '1.0', '1.0-alpha-1'], ['[MRM-122] Deploy the site - ASF JIRA', 'Task', 'Closed', 'Major', 'Fixed', 'None', '1.0-alpha-1'], ['[MRM-123] add RSS view to repository manager - ASF JIRA', 'New Feature', 'Closed', 'Major', 'Fixed', 'None', '1.1'], ['[MRM-124] web service interface - ASF JIRA', 'New Feature', 'Closed', 'Major', 'Fixed', 'None', '1.2-M1'], ['[MRM-125] make discovery only discover new artifacts - ASF JIRA', 'Bug', 'Closed', 'Major', 'Fixed', 'None', '1.0-alpha-1'], ['[MRM-127] refactor and review indexing and search - ASF JIRA', 'Bug', 'Closed', 'Major', 'Fixed', '1.0', '1.0-alpha-1'], ['[MRM-128] better handling of jar artifacts without a pom - ASF JIRA', 'Bug', 'Closed', 'Major', 'Fixed', 'None', '1.0-beta-3'], ['[MRM-129] flush the index periodically during rebuild - ASF JIRA', 'Improvement', 'Closed', 'Major', "Won't Fix", 'None', '1.0-alpha-1'], ['[MRM-130] improve search results page - ASF JIRA', 'Improvement', 'Closed', 'Major', 'Fixed', 'None', '1.4-M3'], ['[MRM-131] complete artifact browsing - ASF JIRA', 'Improvement', 'Closed', 'Major', 'Fixed', 'None', '1.0-alpha-1'], ['[MRM-132] browse interface should accept URL paths - ASF JIRA', 'Improvement', 'Closed', 'Major', 'Fixed', 'None', '1.0-alpha-1'], ['[MRM-133] discovery might not find artifacts added as a result of rsync - ASF JIRA', 'Bug', 'Closed', 'Major', 'Duplicate', 'None', '1.0-alpha-1'], ['[MRM-134] ability to update an existing index without relying on timestamp - ASF JIRA', 'Improvement', 'Closed', 'Major', 'Fixed', 'None', '1.0-alpha-1'], ['[MRM-135] integrate repository sync and conversion in the main application - ASF JIRA', 'New Feature', 'Closed', 'Major', "Won't Fix", 'None', 'Backlog'], ['[MRM-136] improve performance of the browse interface - ASF JIRA', 'Improvement', 'Closed', 'Major', 'Fixed', 'None', '1.0-alpha-1'], ['[MRM-137] add user management and basic security - ASF JIRA', 'New Feature', 'Closed', 'Major', 'Fixed', 'None', '1.0-alpha-1'], ['[MRM-138] complete the proxy interface - ASF JIRA', 'New Feature', 'Closed', 'Major', 'Fixed', 'None', '1.0-alpha-1'], ['[MRM-139] scheduler issues - ASF JIRA', 'Bug', 'Closed', 'Major', 'Fixed', 'None', '1.0-alpha-1'], ['[MRM-140] logging misconfiguration - ASF JIRA', 'Bug', 'Closed', 'Major', 'Fixed', 'None', '1.0-alpha-1'], ['[MRM-141] clean up design documentation - ASF JIRA', 'Task', 'Closed', 'Major', 'Fixed', 'None', 'None'], ['[MRM-142] project builder cache needs to be configurable to prevent memory leaking - ASF JIRA', 'Bug', 'Closed', 'Critical', 'Fixed', 'None', '1.0-beta-3'], ['[MRM-143] improve error reporting on corrupt jars, poms, etc - ASF JIRA', 'Improvement', 'Closed', 'Major', 'Fixed', 'None', '1.0-beta-1'], ['[MRM-144] fix miscellaneous tasks listed in important TODO items - ASF JIRA', 'Task', 'Closed', 'Major', 'Fixed', 'None', '1.0-beta-2'], ['[MRM-145] identify skins and adjust type in index accordingly - ASF JIRA', 'Improvement', 'Closed', 'Major', 'Fixed', 'None', '1.0-alpha-1'], ["[MRM-146] Updates to MRM-Util's Digester to support incremental hashcodes/checksums - ASF JIRA", 'Improvement', 'Closed', 'Major', 'Fixed', 'None', '1.0-alpha-1'], ['[MRM-147] additional index fields - ASF JIRA', 'Improvement', 'Closed', 'Major', 'Fixed', 'None', '1.0-alpha-1'], ['[MRM-148] provide way of zipping the repository index for remote distribution - ASF JIRA', 'New Feature', 'Closed', 'Major', "Won't Fix", 'None', 'None'], ['[MRM-149] create an access log for the proxy - ASF JIRA', 'Task', 'Open', 'Major', 'Unresolved', 'None', 'Backlog'], ['[MRM-150] add field validations for forms - ASF JIRA', 'Task', 'Closed', 'Major', 'Fixed', 'None', '1.0-alpha-1'], ['[MRM-151] re-introduce index of developers and dependencies - ASF JIRA', 'Improvement', 'Closed', 'Major', 'Fixed', 'None', '1.0-alpha-1'], ['[MRM-152] LegacyArtifactDiscoverer doesn"t handle "javadoc.jars" type - ASF JIRA', 'Improvement', 'Closed', 'Major', 'Fixed', 'None', '1.0-alpha-1']]

    print(len(res))
    get_only_bug_version(res)
    wtx.save_to_init_xls(file_headers,res,pro_name,res_name)

if __name__ == '__main__':
    get_jira_info()